<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quiz for Eksamen</title>
  <style>
    :root {
      --bg: #f7f9fc;
      --text: #222;
      --card-bg: #fff;
      --button-bg: #004894;
      --button-text: #fff;
      --button-hover: #0056b3;
      --shadow: rgba(0,0,0,0.08);
    }
    body.dark-mode {
      --bg: #1e1e1e;
      --text: #eee;
      --card-bg: #2e2e2e;
      --button-bg: #555;
      --button-text: #fff;
      --button-hover: #666;
      --shadow: rgba(0,0,0,0.5);
    }
    *, *::before, *::after { box-sizing: border-box; }
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--bg);
      color: var(--text);
      max-width: 700px;
      margin: 20px auto;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 8px 25px var(--shadow);
      transition: background 0.3s, color 0.3s;
    }
    h1 { text-align: center; font-size: clamp(24px,5vw,36px); margin-bottom:20px; }
    .controls {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 8px;
      margin-bottom: 10px;
    }
    #darkToggle {
      background: var(--button-bg);
      color: var(--button-text);
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
      font-size: clamp(14px,3vw,16px);
    }
    #darkToggle:hover { background: var(--button-hover); }
    label { font-size: clamp(16px,4vw,18px); }
    select {
      width: 100%;
      font-size: clamp(16px,4vw,18px);
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button.primary {
      font-size: clamp(16px,4vw,18px);
      width:100%; padding:10px;
      border-radius:6px; border:none;
      background: var(--button-bg);
      color: var(--button-text);
      cursor:pointer;
      transition:background 0.3s;
      margin-top:10px;
    }
    button.primary:hover { background: var(--button-hover); }
    .question { font-size:clamp(18px,5vw,22px); margin:25px 0 15px; }
    .option {
      display:block; width:100%; text-align:left; padding:12px;
      margin:10px 0; border:1px solid #ccc; border-radius:6px;
      background: var(--card-bg); color: var(--text);
      cursor:pointer; transition: background 0.2s;
    }
    .option:hover { background: #ddd; }
    body.dark-mode .option:hover { color: #000; }
    .option:disabled { opacity:0.6; cursor:default; }
    #feedback, #score, #progress { text-align:center; margin-top:20px; }
    /* Flashcard */
    .flashcard { perspective:1000px; width:100%; max-width:400px; height:400px; margin:40px auto; position:relative; touch-action:pan-y; }
    .flashcard-inner { width:100%; height:100%; position:absolute; top:0; left:0; border-radius:20px; transform-style:preserve-3d; transition:transform 0.6s ease; }
    .flipped .flashcard-inner { transform:rotateY(180deg); }
    .flashcard-front, .flashcard-back { position:absolute; width:100%; height:100%; border-radius:20px; backface-visibility:hidden; display:flex; align-items:center; justify-content:center; padding:30px; background: var(--card-bg); color: var(--text); box-shadow: 0 6px 20px var(--shadow); overflow-wrap:break-word; }
    .flashcard-back { transform:rotateY(180deg); font-style:italic; }
    .flashcard-controls { display:flex; justify-content:space-between; align-items:center; margin-top:30px; }
    .flashcard-controls button { background:none; border:none; color: var(--button-bg); font-size:2.5rem; cursor:pointer; visibility:visible; }
    #flashcard-progress { flex:1; text-align:center; }
    /* Slide animation */
    @keyframes slideOutLeft { from{transform:translateX(0);} to{transform:translateX(-100%);} }
    @keyframes slideInRight { from{transform:translateX(100%);} to{transform:translateX(0);} }
    @keyframes slideOutRight { from{transform:translateX(0);} to{transform:translateX(100%);} }
    @keyframes slideInLeft { from{transform:translateX(-100%);} to{transform:translateX(0);} }
    .slide-out-left { animation: slideOutLeft 0.2s forwards; }
    .slide-in-right { animation: slideInRight 0.2s forwards; }
    .slide-out-right { animation: slideOutRight 0.2s forwards; }
    .slide-in-left { animation: slideInLeft 0.2s forwards; }
  </style>
</head>
<body>
  <button id="darkToggle">Dark Mode</button>  
  <h1>EXPH0600 Flervalg og flashcards</h1>
  <div class="controls">
    <label for="temaSelect">Velg tema:</label>
    <select id="temaSelect">
      <option value="Argumentasjonsteori.txt">Argumentasjonsteori</option>
      <option value="Etikk.txt">Etikk</option>
      <option value="Politisk_filosofi.txt">Politisk filosofi</option>
      <option value="Blandede_sporsmaal.txt">Blandede spørsmål fra hele faget</option>
    </select>
  </div>
  <button class="primary" onclick="loadFromTheme('quiz')">Start quiz</button>
  <button class="primary" onclick="loadFromTheme('flashcard')">Flashcards</button>

  <div id="quiz-container" style="display:none;">
    <div id="progress"></div>
    <div class="question" id="question"></div>
    <div id="options"></div>
    <div id="feedback"></div>
    <button class="primary" onclick="nextQuestion()" id="nextBtn" style="display:none;">Neste</button>
  </div>

  <div id="flashcard-container" style="display:none;">
    <div class="flashcard">
      <div class="flashcard-inner">
        <div class="flashcard-front" id="flashcard-question"></div>
        <div class="flashcard-back" id="flashcard-answer"></div>
      </div>
    </div>
    <div class="flashcard-controls">
      <button onclick="navigateFlash('prev')" id="prevBtn">←</button>
      <div id="flashcard-progress"></div>
      <button onclick="navigateFlash('next')" id="nextBtnFlash">→</button>
    </div>
  </div>

  <div id="score"></div>

  <script>
    // Dark mode toggle
    const darkToggle = document.getElementById('darkToggle');
    darkToggle.addEventListener('click', () => {
      const dark = document.body.classList.toggle('dark-mode');
      darkToggle.textContent = dark ? 'Light Mode' : 'Dark Mode';
      localStorage.setItem('darkMode', dark);
    });
    // Load preference
    if (localStorage.getItem('darkMode') === 'true') {
      document.body.classList.add('dark-mode');
      darkToggle.textContent = 'Light Mode';
    }
    // Utility
    function shuffleArray(arr) { for (let i = arr.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; } return arr; }
    function shuffleQuestionOptions(q) { const orig=q.options.map((o,i)=>({o,i})); const sh=shuffleArray(orig); q.options=sh.map(x=>x.o); q.answer=sh.findIndex(x=>x.i===q.answer); return q; }

    // State
    let questions=[],current=0,score=0,flashcardMode=false;
    const cardEl=document.querySelector('.flashcard');

    // Load theme
    function loadFromTheme(mode) {
      flashcardMode=(mode==='flashcard');
      fetch(document.getElementById('temaSelect').value)
        .then(res=>res.text())
        .then(txt=>{ const lines=txt.split('\n').map(l=>l.trim()).filter(Boolean); questions=[]; for (let i=0; i<lines.length; i+=6) { questions.push(shuffleQuestionOptions({ question: lines[i], options: [lines[i+1],lines[i+2],lines[i+3],lines[i+4]], answer: parseInt(lines[i+5],10) })); } shuffleArray(questions); current=0; score=0; document.getElementById('score').textContent=''; document.getElementById('quiz-container').style.display=flashcardMode?'none':'block'; document.getElementById('flashcard-container').style.display=flashcardMode?'block':'none'; flashcardMode?showFlashcardContent():showQuestion(); });
    }
    document.getElementById('temaSelect').addEventListener('change',()=>{ loadFromTheme(flashcardMode?'flashcard':'quiz'); });

    // Quiz functions
    function showQuestion(){ const q=questions[current]; document.getElementById('question').textContent=q.question; document.getElementById('feedback').textContent=''; document.getElementById('nextBtn').style.display='none'; document.getElementById('progress').textContent=`Spørsmål ${current+1} av ${questions.length}`; const optDiv=document.getElementById('options'); optDiv.innerHTML=''; q.options.forEach((opt,i)=>{ const btn=document.createElement('button'); btn.textContent=opt; btn.className='option'; btn.onclick=()=>selectAnswer(i); optDiv.appendChild(btn); }); }
    function selectAnswer(i){ const q=questions[current]; const fb=document.getElementById('feedback'); if(i===q.answer){ fb.textContent='Riktig!'; fb.style.color='green'; score++; }else{ fb.textContent=`Feil! Riktig svar er: ${q.options[q.answer]}`; fb.style.color='red'; } document.querySelectorAll('.option').forEach(b=>b.disabled=true); document.getElementById('nextBtn').style.display='inline'; }
    function nextQuestion(){ current++; if(current<questions.length) showQuestion(); else { document.getElementById('quiz-container').style.display='none'; document.getElementById('score').textContent=`Du fikk ${score} av ${questions.length} riktige!`; } }

    // Flashcard functions
    function showFlashcardContent(){ cardEl.style.transition='none'; cardEl.classList.remove('flipped'); cardEl.offsetHeight; cardEl.style.transition='transform 0.6s ease'; const q=questions[current]; document.getElementById('flashcard-question').textContent=q.question; document.getElementById('flashcard-answer').textContent=q.options[q.answer]; document.getElementById('flashcard-progress').textContent=`Kort ${current+1} av ${questions.length}`; document.getElementById('prevBtn').style.visibility=current===0?'hidden':'visible'; document.getElementById('nextBtnFlash').style.visibility=current===questions.length-1?'hidden':'visible'; }
    function animateSlide(dir,cb){ cardEl.style.transition='none'; cardEl.classList.remove('flipped'); cardEl.offsetHeight; cardEl.style.transition='transform 0.6s ease'; const out=dir==='next'?'slide-out-left':'slide-out-right'; const inn=dir==='next'?'slide-in-right':'slide-in-left'; cardEl.classList.add(out); cardEl.addEventListener('animationend',function h(){ cardEl.removeEventListener('animationend',h); cardEl.classList.remove(out); cb(); cardEl.classList.add(inn); cardEl.addEventListener('animationend',function h2(){ cardEl.removeEventListener('animationend',h2); cardEl.classList.remove(inn); }); }); }
    function navigateFlash(dir){ if(dir==='next'&&current<questions.length-1) animateSlide('next',()=>{ current++; showFlashcardContent(); }); if(dir==='prev'&&current>0) animateSlide('prev',()=>{ current--; showFlashcardContent(); }); }

    // Keyboard & swipe
    document.addEventListener('DOMContentLoaded',()=>{ document.addEventListener('keydown',e=>{ if(flashcardMode){ if(e.key==='ArrowRight'){ e.preventDefault();navigateFlash('next'); } if(e.key==='ArrowLeft'){ e.preventDefault();navigateFlash('prev'); } if(e.key===' '||e.key==='Spacebar'){ e.preventDefault();cardEl.classList.toggle('flipped'); } } else { if(e.key===' '||e.key==='Spacebar'){ e.preventDefault(); if(document.getElementById('nextBtn').style.display!=='none') nextQuestion(); } } }); cardEl.addEventListener('click',()=>{ if(flashcardMode) cardEl.classList.toggle('flipped'); }); let startX=0; cardEl.addEventListener('touchstart',e=>startX=e.changedTouches[0].screenX); cardEl.addEventListener('touchend',e=>{ const dx=e.changedTouches[0].screenX-startX; if(flashcardMode&&Math.abs(dx)>50) navigateFlash(dx<0?'next':'prev'); }); });
  </script>
</body>
</html>
